<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>plugins/core/notifications.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AsyncEventEmitter.html">AsyncEventEmitter</a><ul class='methods'><li data-type='method'><a href="AsyncEventEmitter.html#emit">emit</a></li><li data-type='method'><a href="AsyncEventEmitter.html#off">off</a></li><li data-type='method'><a href="AsyncEventEmitter.html#on">on</a></li><li data-type='method'><a href="AsyncEventEmitter.html#onAll">onAll</a></li><li data-type='method'><a href="AsyncEventEmitter.html#onAllOnce">onAllOnce</a></li><li data-type='method'><a href="AsyncEventEmitter.html#once">once</a></li><li data-type='method'><a href="AsyncEventEmitter.html#removeAllListeners">removeAllListeners</a></li></ul></li><li><a href="CandlesDataPlugin.html">CandlesDataPlugin</a><ul class='methods'><li data-type='method'><a href="CandlesDataPlugin.html#getCandleData">getCandleData</a></li></ul></li><li><a href="ErrorHandlerSelfTestError.html">ErrorHandlerSelfTestError</a></li><li><a href="InternalLogWidget.html">InternalLogWidget</a><ul class='methods'><li data-type='method'><a href="InternalLogWidget.html#onTerminalDebugLog">onTerminalDebugLog</a></li><li data-type='method'><a href="InternalLogWidget.html#onTerminalDebugLogClearLastLine">onTerminalDebugLogClearLastLine</a></li><li data-type='method'><a href="InternalLogWidget.html#onTerminalError">onTerminalError</a></li><li data-type='method'><a href="InternalLogWidget.html#onWSError">onWSError</a></li></ul></li><li><a href="LoggerPlugin.html">LoggerPlugin</a><ul class='methods'><li data-type='method'><a href="LoggerPlugin.html#clearLogOutput">clearLogOutput</a></li><li data-type='method'><a href="LoggerPlugin.html#logDebugClearLastLine">logDebugClearLastLine</a></li><li data-type='method'><a href="LoggerPlugin.html#logOutput">logOutput</a></li></ul></li><li><a href="MarginInfoDataPlugin.html">MarginInfoDataPlugin</a><ul class='methods'><li data-type='method'><a href="MarginInfoDataPlugin.html#getMarginInfo">getMarginInfo</a></li></ul></li><li><a href="MarketInfoDataPlugin.html">MarketInfoDataPlugin</a><ul class='methods'><li data-type='method'><a href="MarketInfoDataPlugin.html#getMarketInfo">getMarketInfo</a></li></ul></li><li><a href="ModuleAddError.html">ModuleAddError</a></li><li><a href="ModuleHost.html">ModuleHost</a></li><li><a href="NotificationsPlugin.html">NotificationsPlugin</a><ul class='methods'><li data-type='method'><a href="NotificationsPlugin.html#notify">notify</a></li><li data-type='method'><a href="NotificationsPlugin.html#notifyError">notifyError</a></li><li data-type='method'><a href="NotificationsPlugin.html#notifyImportant">notifyImportant</a></li><li data-type='method'><a href="NotificationsPlugin.html#notifySuccess">notifySuccess</a></li></ul></li><li><a href="OrderBooksDataPlugin.html">OrderBooksDataPlugin</a></li><li><a href="OrdersDataPlugin.html">OrdersDataPlugin</a></li><li><a href="Plugin.html">Plugin</a></li><li><a href="PositionsDataPlugin.html">PositionsDataPlugin</a></li><li><a href="PublicTradeLogWidget.html">PublicTradeLogWidget</a></li><li><a href="SettingsPlugin.html">SettingsPlugin</a><ul class='methods'><li data-type='method'><a href="SettingsPlugin.html#clearSettings">clearSettings</a></li><li data-type='method'><a href="SettingsPlugin.html#defineSetting">defineSetting</a></li><li data-type='method'><a href="SettingsPlugin.html#getSetting">getSetting</a></li><li data-type='method'><a href="SettingsPlugin.html#listSettings">listSettings</a></li><li data-type='method'><a href="SettingsPlugin.html#notifyListeners">notifyListeners</a></li><li data-type='method'><a href="SettingsPlugin.html#removeSetting">removeSetting</a></li><li data-type='method'><a href="SettingsPlugin.html#setSetting">setSetting</a></li><li data-type='method'><a href="SettingsPlugin.html#subscribeSetting">subscribeSetting</a></li><li data-type='method'><a href="SettingsPlugin.html#unsubscribeSetting">unsubscribeSetting</a></li><li data-type='method'><a href="SettingsPlugin.html#validate">validate</a></li></ul></li><li><a href="Terminal.html">Terminal</a><ul class='methods'><li data-type='method'><a href="Terminal.html#logDuration">logDuration</a></li><li data-type='method'><a href="Terminal.html#onBoot">onBoot</a></li></ul></li><li><a href="TerminalModule.html">TerminalModule</a></li><li><a href="TradeGroupSizeAlertsPlugin.html">TradeGroupSizeAlertsPlugin</a><ul class='methods'><li data-type='method'><a href="TradeGroupSizeAlertsPlugin.html#getGroupSizeAlertThreshold">getGroupSizeAlertThreshold</a></li><li data-type='method'><a href="TradeGroupSizeAlertsPlugin.html#setTradeGroupSizeAlertThreshold">setTradeGroupSizeAlertThreshold</a></li></ul></li><li><a href="TradeGroupsPlugin.html">TradeGroupsPlugin</a></li><li><a href="TradesDataPlugin.html">TradesDataPlugin</a></li><li><a href="TradeSizeAlertsPlugin.html">TradeSizeAlertsPlugin</a><ul class='methods'><li data-type='method'><a href="TradeSizeAlertsPlugin.html#getTradeSizeAlertThreshold">getTradeSizeAlertThreshold</a></li><li data-type='method'><a href="TradeSizeAlertsPlugin.html#setTradeSizeAlertThreshold">setTradeSizeAlertThreshold</a></li></ul></li><li><a href="Widget.html">Widget</a></li><li><a href="WSConnectionPlugin.html">WSConnectionPlugin</a></li></ul><h3>Modules</h3><ul><li><a href="module-Utility.html">Utility</a><ul class='methods'><li data-type='method'><a href="module-Utility.html#.measureDuration">measureDuration</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="CandlesDataPlugin.html#~event:dataCandles">dataCandles</a></li><li><a href="LoggerPlugin.html#~event:terminalDebugLog">terminalDebugLog</a></li><li><a href="LoggerPlugin.html#~event:terminalDebugLogClearLastLine">terminalDebugLogClearLastLine</a></li><li><a href="LoggerPlugin.html#~event:terminalOutputClear">terminalOutputClear</a></li><li><a href="LoggerPlugin.html#~event:terminalOutputLog">terminalOutputLog</a></li><li><a href="MarginInfoDataPlugin.html#~event:dataMarginInfo">dataMarginInfo</a></li><li><a href="MarketInfoDataPlugin.html#~event:dataMarketInfo">dataMarketInfo</a></li><li><a href="NotificationsPlugin.html#~event:notify">notify</a></li><li><a href="NotificationsPlugin.html#~event:notifyError">notifyError</a></li><li><a href="NotificationsPlugin.html#~event:notifyImportant">notifyImportant</a></li><li><a href="NotificationsPlugin.html#~event:notifySuccess">notifySuccess</a></li><li><a href="OrderBooksDataPlugin.html#~event:dataOrderBook">dataOrderBook</a></li><li><a href="OrdersDataPlugin.html#~event:dataOrderClosed">dataOrderClosed</a></li><li><a href="OrdersDataPlugin.html#~event:dataOrderCreated">dataOrderCreated</a></li><li><a href="OrdersDataPlugin.html#~event:dataOrderSnapshot">dataOrderSnapshot</a></li><li><a href="OrdersDataPlugin.html#~event:dataOrderUpdated">dataOrderUpdated</a></li><li><a href="PositionsDataPlugin.html#~event:dataPositionClosed">dataPositionClosed</a></li><li><a href="PositionsDataPlugin.html#~event:dataPositionCreated">dataPositionCreated</a></li><li><a href="PositionsDataPlugin.html#~event:dataPositionSnapshot">dataPositionSnapshot</a></li><li><a href="PositionsDataPlugin.html#~event:dataPositionUpdated">dataPositionUpdated</a></li><li><a href="Terminal.html#~event:terminalBooted">terminalBooted</a></li><li><a href="Terminal.html#~event:terminalError">terminalError</a></li><li><a href="TradeGroupSizeAlertsPlugin.html#~event:groupSizeAlertThresholdUpdated">groupSizeAlertThresholdUpdated</a></li><li><a href="TradeGroupsPlugin.html#~event:buyTradeGroupUpdate">buyTradeGroupUpdate</a></li><li><a href="TradeGroupsPlugin.html#~event:sellTradeGroupUpdate">sellTradeGroupUpdate</a></li><li><a href="TradesDataPlugin.html#~event:dataAccountTradeEntry">dataAccountTradeEntry</a></li><li><a href="TradesDataPlugin.html#~event:dataAccountTradeUpdate">dataAccountTradeUpdate</a></li><li><a href="TradesDataPlugin.html#~event:dataTradeEntry">dataTradeEntry</a></li><li><a href="TradeSizeAlertsPlugin.html#~event:tradeSizeAlertThresholdUpdated">tradeSizeAlertThresholdUpdated</a></li><li><a href="WSConnectionPlugin.html#~event:wsAuthenticated">wsAuthenticated</a></li><li><a href="WSConnectionPlugin.html#~event:wsClosed">wsClosed</a></li><li><a href="WSConnectionPlugin.html#~event:wsError">wsError</a></li><li><a href="WSConnectionPlugin.html#~event:wsOpened">wsOpened</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">plugins/core/notifications.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict'

const { sprintf } = require('sprintf-js')
const notifier = require('node-notifier')
const _isArray = require('lodash/isArray')
const Plugin = require('../plugin')

/**
 * Provides helpers tied to event listeners to emit desktop notifications,
 * and attaches them to the terminal for alternative access
 */
class NotificationsPlugin extends Plugin {
  /**
   * @param {Terminal} terminal - terminal instance
   */
  constructor (terminal) {
    super('core:notifications', {
      terminal,
      providedHooks: [
        'notifyImportant',
        'notifySuccess',
        'notifyError',
        'notify'
      ],

      hooks: {
        notifyImportant: 'onNotifyImportant',
        notifySuccess: 'onNotifySuccess',
        notifyError: 'onNotifyError',
        notify: 'notify'
      },

      terminalMethods: [
        'notifyImportant',
        'notifySuccess',
        'notifyError',
        'notify'
      ]
    })
  }

  /**
   * Attached to the terminal instance
   *
   * @fires NotificationsPlugin~notifyImportant
   *
   * @param {string} title - notification title
   * @param {string} message - notification message
   */
  notifyImportant (title, message) {
    /**
     * Fired when an important notification should be shown on the desktop
     *
     * @event NotificationsPlugin~notifyImportant
     * @property {string} title - notification title
     * @property {string} message - notification message
     */
    this.emitSync('notifyImportant', { title, message })
  }

  /**
   * Attached to the terminal instance
   *
   * @fires NotificationsPlugin~notifySuccess
   *
   * @param {string} title - notification title
   * @param {string} message - notification message
   */
  notifySuccess (title, message) {
    /**
     * Fired when a success notification should be shown on the desktop
     *
     * @event NotificationsPlugin~notifySuccess
     * @property {string} title - notification title
     * @property {string} message - notification message
     */
    this.emitSync('notifySuccess', { title, message })
  }

  /**
   * Attached to the terminal instance
   *
   * @fires NotificationsPlugin~notifyError
   *
   * @param {string} title - notification title
   * @param {string} message - notification message
   */
  notifyError (title, message) {
    /**
     * Fired when an error notification should be shown on the desktop
     *
     * @event NotificationsPlugin~notifyError
     * @property {string} title - notification title
     * @property {string} message - notification message
     */
    this.emitSync('notifyError', { title, message })
  }

  /**
   * Attached to the terminal instance
   *
   * @fires NotificationsPlugin~notify
   *
   * @param {string} title - notification title
   * @param {string} message - notification message
   */
  notify (title, message) {
    /**
     * Fired when generic notification should be shown on the desktop
     *
     * @event NotificationsPlugin~notify
     * @property {string} title - notification title
     * @property {string} message - notification message
     */
    this.emitSync('notify', { title, message })
  }

  /**
   * @private
   * @param {object} data - payload
   * @param {string} data.title - notification title
   * @param {string} data.message - notification message
   */
  onNotifySuccess ({ title, message }) {
    const t = _isArray(title) ? title : [title]
    const m = _isArray(message) ? message : [message]

    this.doNotify({
      title: `Success: ${sprintf(...t)}`,
      message: sprintf(...m)
    })
  }

  /**
   * @private
   * @param {object} data - payload
   * @param {string} data.title - notification title
   * @param {string} data.message - notification message
   */
  onNotifyImportant ({ title, message }) {
    const t = _isArray(title) ? title : [title]
    const m = _isArray(message) ? message : [message]

    this.doNotify({
      title: `Important: ${sprintf(...t)}`,
      message: sprintf(...m)
    })
  }

  /**
   * @private
   * @param {object} data - payload
   * @param {string} data.title - notification title
   * @param {string} data.message - notification message
   */
  onNotifyError ({ title, message }) {
    const t = _isArray(title) ? title : [title]
    const m = _isArray(message) ? message : [message]

    this.doNotify({
      title: `Error: ${sprintf(...t)}`,
      message: sprintf(...m)
    })
  }

  /**
   * @private
   * @param {object} data - payload
   * @param {string} data.title - notification title
   * @param {string} data.message - notification message
   */
  doNotify ({ title, message }) {
    const enabled = this.getTerminal().getNotificationsEnabled()

    if (!enabled) {
      return
    }

    notifier.notify({
      title,
      message
    })
  }
}

module.exports = NotificationsPlugin
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Tue Apr 07 2020 07:43:57 GMT+0700 (Indochina Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>
